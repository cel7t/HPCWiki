"use strict";(self.webpackChunkhpc_wiki=self.webpackChunkhpc_wiki||[]).push([[163],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return d}});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=o.createContext({}),u=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=u(e.components);return o.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=u(n),d=a,h=m["".concat(s,".").concat(d)]||m[d]||p[d]||r;return n?o.createElement(h,i(i({ref:t},c),{},{components:n})):o.createElement(h,i({ref:t},c))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var u=2;u<r;u++)i[u]=n[u];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},2430:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return s},default:function(){return d},frontMatter:function(){return l},metadata:function(){return u},toc:function(){return p}});var o=n(7462),a=n(3366),r=(n(7294),n(3905)),i=["components"],l={sidebar_position:7,sidebar_label:"Job Scheduling",hide_table_of_contents:!0,hide_title:!0,pagination_next:null,pagination_prev:null,title:"Job Scheduling"},s=void 0,u={unversionedId:"faq/jobs/jobs",id:"faq/jobs/jobs",title:"Job Scheduling",description:"Job Scheduling",source:"@site/docs/faq/jobs/jobs.md",sourceDirName:"faq/jobs",slug:"/faq/jobs/",permalink:"/docs/faq/jobs/",tags:[],version:"current",sidebarPosition:7,frontMatter:{sidebar_position:7,sidebar_label:"Job Scheduling",hide_table_of_contents:!0,hide_title:!0,pagination_next:null,pagination_prev:null,title:"Job Scheduling"},sidebar:"FAQ"},c={},p=[{value:"Job Scheduling",id:"job-scheduling",level:2},{value:"What is Slurm?",id:"what-is-slurm",level:3},{value:"What are the frequently used commands for Slurm?",id:"what-are-the-frequently-used-commands-for-slurm",level:3},{value:"How to view the status of partitions?",id:"how-to-view-the-status-of-partitions",level:3},{value:"How to view my submitted jobs?",id:"how-to-view-my-submitted-jobs",level:3},{value:"How to cancel my job?",id:"how-to-cancel-my-job",level:3},{value:"How to control my job?",id:"how-to-control-my-job",level:3},{value:"Can I run my code for a few minutes on the login node?",id:"can-i-run-my-code-for-a-few-minutes-on-the-login-node",level:3},{value:"How can I monitor the output of my jobs that are running?",id:"how-can-i-monitor-the-output-of-my-jobs-that-are-running",level:3},{value:"Can I run interactive jobs?",id:"can-i-run-interactive-jobs",level:3},{value:"I have job scripts written for another job scheduler. Can I use them for Slurm?",id:"i-have-job-scripts-written-for-another-job-scheduler-can-i-use-them-for-slurm",level:3},{value:"When is my job going to start to run?",id:"when-is-my-job-going-to-start-to-run",level:3},{value:"Why is my job not running?",id:"why-is-my-job-not-running",level:3},{value:"BadConstraints",id:"badconstraints",level:4},{value:"Cleaning",id:"cleaning",level:4},{value:"Dependency",id:"dependency",level:4},{value:"JobHeldAdmin",id:"jobheldadmin",level:4},{value:"JobHeldUser",id:"jobhelduser",level:4},{value:"NonZeroExitCode",id:"nonzeroexitcode",level:4},{value:"PartitionDown",id:"partitiondown",level:4},{value:"Priority",id:"priority",level:4},{value:"QOSResourceLimit",id:"qosresourcelimit",level:4},{value:"ReqNodeNotAvail",id:"reqnodenotavail",level:4},{value:"Resources",id:"resources",level:4},{value:"TimeLimit",id:"timelimit",level:4}],m={toc:p};function d(e){var t=e.components,n=(0,a.Z)(e,i);return(0,r.kt)("wrapper",(0,o.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"job-scheduling"},"Job Scheduling"),(0,r.kt)("h3",{id:"what-is-slurm"},"What is Slurm?"),(0,r.kt)("p",null,"Slurm is an open source, fault-tolerant, and highly scalable cluster management and job scheduling system for clusters. It facilitates the execution of parallel jobs on the cluster in an efficient manner. For more information on Slurm, users are requested to visit ",(0,r.kt)("a",{parentName:"p",href:"https://slurm.schedmd.com/documentation.html"},"Slurm Workload Manager - Documentation"),"."),(0,r.kt)("h3",{id:"what-are-the-frequently-used-commands-for-slurm"},"What are the frequently used commands for Slurm?"),(0,r.kt)("p",null,"Here is the list of frequently used commands. For more information, users are requested to refer ",(0,r.kt)("a",{parentName:"p",href:"https://slurm.schedmd.com/documentation.html"},"Slurm Workload Manager -\nDocumentation"),"."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"salloc")," - To allocate resources to a Slurm job with a possible\nset of constraints.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"sbatch")," - Submits a Slurm job script.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"scancel")," - Cancels a Slurm job.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"scontrol")," - To query information and manage jobs.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"sinfo")," - To retrieve information about partitions and nodes.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"squeue")," - To query the list of pending and running jobs.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"srun")," - To run a parallel job on the cluster managed by Slurm."))),(0,r.kt)("h3",{id:"how-to-view-the-status-of-partitions"},"How to view the status of partitions?"),(0,r.kt)("p",null,"Users can use the ",(0,r.kt)("inlineCode",{parentName:"p"},"sinfo")," command to view the status of partitions and nodes."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ sinfo\n")),(0,r.kt)("p",null,"Alternatively, users can run ",(0,r.kt)("inlineCode",{parentName:"p"},"scontrol show partition")," to know about partitions and their limits."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ scontrol show partition\n")),(0,r.kt)("h3",{id:"how-to-view-my-submitted-jobs"},"How to view my submitted jobs?"),(0,r.kt)("p",null,"To view all the current jobs of a user, please type the following command."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ squeue -u <username>\n")),(0,r.kt)("p",null,"To view all the running jobs of a user, please type"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ squeue -u <username> -t RUNNING\n")),(0,r.kt)("h3",{id:"how-to-cancel-my-job"},"How to cancel my job?"),(0,r.kt)("p",null,"To cancel a particular job by its ",(0,r.kt)("inlineCode",{parentName:"p"},"jobid"),", use the following command."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ scancel <jobid>\n")),(0,r.kt)("p",null,"To cancel a job by its name, please type"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ scancel --name <jobname>\n")),(0,r.kt)("p",null,"To cancel all the jobs of a user"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ scancel -u <username>\n")),(0,r.kt)("p",null,"To cancel all the ",(0,r.kt)("inlineCode",{parentName:"p"},"PENDING")," jobs of a user"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ scancel -t PENDING -u <username>\n")),(0,r.kt)("h3",{id:"how-to-control-my-job"},"How to control my job?"),(0,r.kt)("p",null,"To hold a job from being scheduled"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ scontrol hold <jobid>\n")),(0,r.kt)("p",null,"To release a job to be scheduled"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ scontrol release <jobid>\n")),(0,r.kt)("p",null,"To requeue (cancel or rerun) a job"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ scontrol requeue <jobid>\n")),(0,r.kt)("p",null,"For more information, users can use ",(0,r.kt)("inlineCode",{parentName:"p"},"man scontrol"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"man squeue"),",\n",(0,r.kt)("inlineCode",{parentName:"p"},"man scancel"),", etc."),(0,r.kt)("h3",{id:"can-i-run-my-code-for-a-few-minutes-on-the-login-node"},"Can I run my code for a few minutes on the login node?"),(0,r.kt)("p",null,"Users are not authorized to run their codes on the login node. Codes running on login nodes will be terminated automatically. Jobs ",(0,r.kt)("strong",{parentName:"p"},"have")," to be submitted through the scheduler."),(0,r.kt)("h3",{id:"how-can-i-monitor-the-output-of-my-jobs-that-are-running"},"How can I monitor the output of my jobs that are running?"),(0,r.kt)("p",null,"Users can access the output and error logs generated by Slurm while running their codes using the ",(0,r.kt)("inlineCode",{parentName:"p"},"tail")," command. Users are strongly recommended to use the example scripts given above as a base for their job scripts. Job logs are written to the current directory, from which the Slurm job was executed by ",(0,r.kt)("inlineCode",{parentName:"p"},"sbatch"),"."),(0,r.kt)("p",null,"Please note that by default ",(0,r.kt)("inlineCode",{parentName:"p"},"sbatch")," does not write the output logs. The example provided above instructs Slurm to dump the output in the format of ",(0,r.kt)("inlineCode",{parentName:"p"},"slurm.<jobid>.out"),", where ",(0,r.kt)("inlineCode",{parentName:"p"},"<jobid>")," is the job id of the slurm job. Users can use the ",(0,r.kt)("inlineCode",{parentName:"p"},"tail")," command with ",(0,r.kt)("inlineCode",{parentName:"p"},"-f")," flag to view the output file being written continuously by Slurm."),(0,r.kt)("p",null,"For example, if a user has a job with the job id 121, and would like to view the job output, then use the following syntax."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ tail -f slurm.121.out\n")),(0,r.kt)("p",null,"Alternatively, users can use ",(0,r.kt)("inlineCode",{parentName:"p"},"vi")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"nano")," to view the output file after the job is completed."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ vi slurm.121.out\n$ nano slurm.121.out\n")),(0,r.kt)("h3",{id:"can-i-run-interactive-jobs"},"Can I run interactive jobs?"),(0,r.kt)("p",null,"Yes, the facility provides users access to interactive job scheduling. Users can use the ",(0,r.kt)("inlineCode",{parentName:"p"},"srun")," command to setup an interactive session on the nodes. Consider an example where a user wants to request 2 nodes with 64 cores per node."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ srun -N 2 -n 1 -c 128 -p compute --pty bash -i\n")),(0,r.kt)("p",null,"Here, ",(0,r.kt)("inlineCode",{parentName:"p"},"-N")," is the number of nodes to be used. ",(0,r.kt)("inlineCode",{parentName:"p"},"-n")," is the number of tasks (instances) to be executed. ",(0,r.kt)("inlineCode",{parentName:"p"},"-c")," is the number of cores required for the task. ",(0,r.kt)("inlineCode",{parentName:"p"},"-p")," is the partition to be used. In the present example, we chose the ",(0,r.kt)("inlineCode",{parentName:"p"},"compute")," partition. ",(0,r.kt)("inlineCode",{parentName:"p"},"--pty bash")," instructs Slurm to setup a pseudo terminal in bash. ",(0,r.kt)("inlineCode",{parentName:"p"},"-i")," tells Slurm to run this command in interactive mode."),(0,r.kt)("h3",{id:"i-have-job-scripts-written-for-another-job-scheduler-can-i-use-them-for-slurm"},"I have job scripts written for another job scheduler. Can I use them for Slurm?"),(0,r.kt)("p",null,"No, you cannot execute job scripts written for other job schedulers using Slurm. But, the developers of Slurm have provided users with a documentation containing the correspondences between the options of several job schedulers. Users can access the documentation at this link. ",(0,r.kt)("a",{parentName:"p",href:"https://slurm.schedmd.com/rosetta.pdf"},"Rosetta stone of Workload manager"),"."),(0,r.kt)("h3",{id:"when-is-my-job-going-to-start-to-run"},"When is my job going to start to run?"),(0,r.kt)("p",null,"To get an estimate of when your job is going to start, users can use the ",(0,r.kt)("inlineCode",{parentName:"p"},"squeue")," command."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ squeue --start -j <jobid>\n")),(0,r.kt)("p",null,"Please note that your job might run before the scheduled start time as jobs that have finished earlier than their requested walltime might free up the queue and resources needed for your job."),(0,r.kt)("h3",{id:"why-is-my-job-not-running"},"Why is my job not running?"),(0,r.kt)("p",null,"There are several reasons why your job is not running. Users can run the ",(0,r.kt)("inlineCode",{parentName:"p"},"squeue")," command to get the status and reason."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ squeue -j <jobid> -l\n")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"NODELIST(REASON)")," section in the output of the above command will have the reason, why Slurm is unable to run the job. Here are the most common reasons."),(0,r.kt)("h4",{id:"badconstraints"},"BadConstraints"),(0,r.kt)("p",null,"The job's constraints can not be satisfied."),(0,r.kt)("h4",{id:"cleaning"},"Cleaning"),(0,r.kt)("p",null,"The job is being requeued and still cleaning up from its previous execution."),(0,r.kt)("h4",{id:"dependency"},"Dependency"),(0,r.kt)("p",null,"This job is waiting for a dependent job to complete."),(0,r.kt)("h4",{id:"jobheldadmin"},"JobHeldAdmin"),(0,r.kt)("p",null,"The job is held by a system administrator. Please contact the system administrator for more information."),(0,r.kt)("h4",{id:"jobhelduser"},"JobHeldUser"),(0,r.kt)("p",null,"The job is held by the user."),(0,r.kt)("h4",{id:"nonzeroexitcode"},"NonZeroExitCode"),(0,r.kt)("p",null,"The job terminated with a non-zero exit code."),(0,r.kt)("h4",{id:"partitiondown"},"PartitionDown"),(0,r.kt)("p",null,"The partition required by this job is in a DOWN state."),(0,r.kt)("h4",{id:"priority"},"Priority"),(0,r.kt)("p",null,"One or more higher priority jobs exist for this partition or advanced reservation."),(0,r.kt)("h4",{id:"qosresourcelimit"},"QOSResourceLimit"),(0,r.kt)("p",null,"The job's Quality of Service (QOS) has reached some resource limit."),(0,r.kt)("h4",{id:"reqnodenotavail"},"ReqNodeNotAvail"),(0,r.kt)("p",null,"Some node specifically required by the job is not currently available."),(0,r.kt)("h4",{id:"resources"},"Resources"),(0,r.kt)("p",null,"The job is waiting for resources to become available."),(0,r.kt)("h4",{id:"timelimit"},"TimeLimit"),(0,r.kt)("p",null,"The job exhausted its time limit."))}d.isMDXComponent=!0}}]);